---

description: Defines advanced tech stack configuration and metadata integration patterns for React + TypeScript + Vite projects. Focuses on optimization and DDD-based development beyond basic setup.
alwaysApply: false
---

# Advanced Frontend Tech Stack and Metadata Integration

This rule defines tech stack configuration for advanced features and metadata-based development after basic project setup is complete.

**Prerequisites**: Basic React + TypeScript + Vite project must already be set up.

## Metadata Integration Technologies

### Event Storming and DDD Integration
- **OpenAPI Integration**: Automatic type generation from Swagger/OpenAPI specifications
- **Code Generation**: Automatic component generation based on metadata
- **CQRS Support**: Command/Query separation pattern
- **Aggregate Pattern**: Aggregate-based component structure

## State Management (Zustand)

### Aggregate-Based Store Pattern
- **Store Structure**: `items[]`, `selectedItem`, `loading`, `error` + setters
- **File Pattern**: `src/store/[boundedContext]/[aggregate].store.ts`
- **Zustand Usage**: Use `create<State>((set) => ({ ... }))` with TypeScript interfaces

## Router Configuration (React Router + Metadata)

### Dynamic Route Generation
- **Route Structure**: BoundedContext (`/${bc.name}`) → Aggregate (`/{bc.name}/{agg.namePlural}`) → Views (CQRS only)
- **File Pattern**: `src/utils/route-generator.ts` using metadata-based route generation
- **App Configuration**: QueryClient + ThemeProvider + Router with generated routes

## React Hook Patterns (React Query + Zustand)

### Hook Architecture
- **Aggregate Hooks**: `useQuery` for lists, `useMutation` for CRUD operations
- **Command Hooks**: `useMutation` for non-REST commands with query invalidation
- **ReadModel Hooks**: `useQuery` with search parameters for CQRS views
- **File Pattern**: `src/hooks/[boundedContext]/use[Entity].ts`

### Query Configuration
- **Cache Settings**: 5min staleTime, 10min cacheTime, 3 retries
- **Error Handling**: Integration with Zustand store for error states
- **Invalidation**: Automatic query invalidation on changes

## API Service Patterns (Axios + Gateway)

### Service Architecture
- **Aggregate Services**: Full CRUD with HAL JSON transformation (`/{namePlural}`)
- **Spring Data REST Responses**: All API responses must be handled in Spring Data REST format (HAL JSON, _embedded, _links, page info, etc.)
- **Command Services**: Custom endpoints (`/{aggregates.namePlural}/{id}/{command.name}`)
- **Query Services**: Search with parameters (`/{views.namePlural}`)
- **File Pattern**: `src/services/[boundedContext]/[entity].service.ts`

### Gateway Integration
- **Base URL**: Local: `http://localhost:3000`, Gateway: `http://localhost:8088`
- **HAL JSON**: Automatic transformation for Spring Data REST format
- **Error Handling**: Unified error handling using interceptors

## Development Guidelines and Integration

### Component Development Principles
1. **Metadata-Based**: All components generated from Event Storming metadata
2. **Type Safety**: Complete synchronization between domain models and UI types
3. **Domain Separation**: Component separation by BoundedContext
4. **CQRS Pattern**: Command/Query responsibility separation

### Performance Optimization
- **Lazy Loading**: Dynamic import for metadata-based components
- **Memoization**: React.memo using metadata fieldDescriptor comparison
- **Code Splitting**: Route-based splitting for BoundedContext modules

### TypeScript and Environment Configuration
- **Metadata Types**: AggregateMetadata, CommandMetadata, ViewMetadata interfaces
- **Environment Variables**: `VITE_GATEWAY_URL`, `VITE_API_BASE_URL`, `VITE_OPENAPI_URL`
- **OpenAPI Integration**: Auto-generated types from OpenAPI specifications

### API Integration Patterns
- **Endpoint Generation**: Metadata-based API endpoint mapping
- **Spring Gateway**: Use port 8088 with HAL JSON transformation
- **Backend API Communication**: Integrate axios processing by referring to API endpoints from infra/**Controller.java and domain/**Repository.java files in backend services
